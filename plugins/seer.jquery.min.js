$.widget("custom.catcomplete",$.ui.autocomplete,{_create:function(){this._super();this.widget().menu("option","items","> :not(.ui-autocomplete-category)");String.prototype.trunc=function(c,b){var a=this.length>c,d=a?this.substr(0,c-1):this;return b&&a?d.substr(0,d.lastIndexOf(" ")):d}},_renderItem:function(c,b){var a="",d=b.br?b.br+" ":"",f=b.ca?b.ca+" ":"",e=b.ti.trunc(40,!0),g="R$ "+b.cp,h="";switch(b.ty){case 0:a=d?'<span class="dj-itemCategory">'+d+' <span class="dj-seperator">em</span> '+e+"</span>":
'<span class="dj-itemCategory">'+e+' <span class="dj-seperator">em</span> '+f+"</span>";break;case 1:a=(b.th?'<span class="dj-itemThumbnail"><img src="'+imgUrl+"/m_"+b.th+'"></span>':"")+'<span class="dj-itemProduct"><strong class="dj-itemBrand">'+d+'</strong><span class="dj-itemTitle">'+e+'</span><strong class="dj-itemPrice">'+g+"</strong></span>";h="dj-product";break;case 2:a=f?'<span class="dj-itemCategory">'+e+' <span class="dj-seperator">in</span> '+f+"</span>":'<span class="dj-itemCategory">'+
e+"</span>"}a='<a href="#">'+a+"</a>";return $("<li>").addClass(h).append(a).appendTo(c)},_renderMenu:function(c,b){var a=this,d=-1,f="";$.each(b,function(b,g){if(g.ty!=d){switch(g.ty){case 0:f="SUGEST\u00d5ES DE BUSCA";break;case 1:f="PRODUTOS RELACIONADOS";break;case 2:f="Search for"}c.append("<li class='dj-section'>"+f+"</li>");d=g.ty}a._renderItemData(c,g)})}});
$(function(){$("#suggestions").catcomplete({delay:0,appendTo:"#suggestionResults",select:function(c,b){c.preventDefault();window.location.href="http://"+b.item.li;return!1},messages:{noResults:"",results:function(){}},source:function(c,b){suggest.get(c.term,function(a){if(a){var d=[],c=[],e=[];$.each(a,function(b,a){switch(a.ty){case 1:4>e.length&&e.push(a);break;case 0:5>d.length&&d.push(a);break;case 2:c.push(a)}});a=d.concat(e).concat(c)}else a=[{ty:1,ti:"No matches found",cat:b.term}];b(a)})}})});